tidyr::complete(exit_way, fill = list(frequency = 0, proportion = 0))
T2_Tortoise_proportion <- type_2_data %>%
filter(species == "Tortoise") %>%
group_by(exit_way) %>%
summarise(frequency = n(), .groups = 'drop') %>%
mutate(proportion = frequency / sum(frequency) * 100) %>%
ungroup() %>%
mutate(exit_way = factor(exit_way, levels = c("trench", "rail", "barrier", "unable"),
labels = c("Trench", "Tracks", "Barrier", "No exit")))
NoTrench_Slider_proportion <- no_trench_data %>%
filter(species == "Trachemys") %>%
group_by(exit_way) %>%
summarise(frequency = n(), .groups = 'drop') %>%
mutate(proportion = frequency / sum(frequency) * 100) %>%
ungroup() %>%
mutate(exit_way = factor(exit_way, levels = c("rail", "unable"),
labels = c("Tracks", "No exit")))
NoTrench_Tortoise_proportion <- no_trench_data %>%
filter(species == "Tortoise") %>%
group_by(exit_way) %>%
summarise(frequency = n(), .groups = 'drop') %>%
mutate(proportion = frequency / sum(frequency) * 100) %>%
ungroup() %>%
mutate(exit_way = factor(exit_way, levels = c("rail", "unable"),
labels = c("Tracks", "No exit"))) %>%
tidyr::complete(exit_way, fill = list(frequency = 0, proportion = 0))
(T1_T <- ggplot(T1_Tortoise_proportion, aes(x = exit_way, y = proportion, fill = exit_way)) +
geom_bar(stat = "identity", position = "dodge", width = 0.4) +
labs(x = "Exit way",  y = "Exit proportion in the trials") +
scale_y_continuous(labels = scales::percent_format(scale = 1), limits = c(0,100)) +
scale_fill_manual(values = c("#08589e", "#2b8cbe", "#4eb3d3", "#FFCC99")) +
theme_minimal() +
theme(legend.position = "none",
axis.text.y = element_text(size = 18.5),
axis.title = element_text(size = 18),
axis.text.x = element_text(size = 16.5, vjust = 4),
plot.title = element_text(size = 19),
panel.grid.major.x = element_blank(),
panel.grid.minor = element_blank()) )
T1_T_image <- ggdraw() +
draw_image(tortoise, x = 0.27, y = 0, width = 0.5, height = 0.5) +
draw_label("Type 1 (n = 57)", x = 0.08, y = 0.25, hjust = 0, size = 17)
(T1_T_final <- plot_grid(T1_T_image, T1_T, ncol = 1,  rel_heights = c(0.2, 1)) )
ggsave(filename = here::here("figures", "T1_escape2.jpg"),  plot = T1_T_final,
width = 5, height = 6, units = "in", dpi = 300)
ggsave(filename = here::here("figures", "T1_escape.jpg"),  plot = T1_T_final,
width = 5, height = 6, units = "in", dpi = 300)
ggsave(filename = here::here("figures", "T1_escape.jpg"),  plot = T1_T_final,
width = 5, height = 6, units = "in", dpi = 300)
(T2_S <- ggplot(T2_Slider_proportion, aes(x = exit_way, y = proportion, fill = exit_way)) +
geom_bar(stat = "identity", position = "dodge", width = 0.4) +
labs(x = "Exit way",  y = "Exit proportion in the trials") +
scale_y_continuous(labels = scales::percent_format(scale = 1), limits = c(0,100)) +
scale_fill_manual(values = c("#08589e", "#2b8cbe", "#4eb3d3", "#FFCC99")) +
theme_minimal() +
theme(legend.position = "none",
axis.text.y = element_text(size = 18.5),
axis.title = element_text(size = 18),
axis.text.x = element_text(size = 16.5, vjust = 4),
plot.title = element_text(size = 19),
panel.grid.major.x = element_blank(),
panel.grid.minor = element_blank()) )
T2_S_image <- ggdraw() +
draw_image(trachemys, x = 0.29, y = 0, width = 0.55, height = 0.55) +
draw_label("A) Type 2 (n = 60)", x = 0.08, y = 0.25, hjust = 0, size = 17)
(T2_S_final <- plot_grid(T2_S_image, T2_S, ncol = 1,  rel_heights = c(0.2, 1)) )
(T2_T <- ggplot(T2_Tortoise_proportion, aes(x = exit_way, y = proportion, fill = exit_way)) +
geom_bar(stat = "identity", position = "dodge", width = 0.4) +
labs(x = "Exit way",  y = " ") +
scale_y_continuous(labels = scales::percent_format(scale = 1), limits = c(0,100)) +
scale_fill_manual(values = c("#08589e", "#2b8cbe", "#4eb3d3", "#FFCC99")) +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_text(size = 18),
axis.text.x = element_text(size = 16.5, vjust = 4),
axis.text.y = element_blank(),
plot.title = element_text(size = 19),
panel.grid.major.x = element_blank(),
panel.grid.minor = element_blank()) )
T2_T_image <- ggdraw() +
draw_image(tortoise, x = 0.32, y = 0, width = 0.5, height = 0.5) +
draw_label("B) Type 2 (n = 33)", x = 0.08, y = 0.25, hjust = 0, size = 17)
(T2_T_final <- plot_grid(T2_T_image, T2_T, ncol = 1,  rel_heights = c(0.2, 1)) )
panel_P2 <- (T2_S_final | T2_T_final)
panel_P2
ggsave(filename = here::here("figures", "T2_escape.png"),  plot = panel_P2,
width = 10, height = 6, units = "in", dpi = 300)
(NT_S <- ggplot(NoTrench_Slider_proportion, aes(x = saida, y = proportion, fill = saida)) +
geom_bar(stat = "identity", position = "dodge", width = 0.4) +
labs(x = "Exit way",  y = "Exit proportion in the trials") +
scale_y_continuous(labels = scales::percent_format(scale = 1), limits = c(0,100)) +
scale_fill_manual(values = c("#2b8cbe", "#FFCC99")) +
theme_minimal() +
theme(legend.position = "none",
axis.text = element_text(size = 15.5),
axis.title = element_text(size = 17),
axis.text.x = element_text(angle = 45, v = 1.7, h = 1.5),
plot.title = element_text(size = 17),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()) )
library(lme4)
library(dplyr)
library(car)
general_data <- read.csv(here::here("SM2_trench_trials.csv"), sep = ";")
View(general_data)
type2_data <- general_data %>%
filter(type == 2)
View(type2_data)
str(type2_data)
type2_data <- general_data %>%
filter(type == 2) %>%
mutate(trench_use = ifelse(exit_way == "trench", 1, 0),
individual = as.factor(individual),
species = as.factor(species) )
View(type2_data)
type2_data <- general_data %>%
filter(type == 2) %>%
mutate(trench_use = ifelse(exit_way == "trench", 1, 0),
individual = as.factor(individual),
species = as.factor(species) )
# NOTA: O R pode mostrar um "warning" sobre a escala se um grupo
# (ex: uma espécie) tiver 0% ou 100% de sucesso. Isso é normal.
modelo <- glmer(trench_use ~ species + (1 | individual), data = type2_data, family = binomial(link = "logit"))
summary(modelo)
# 2. Obtendo o p-valor principal (teste do efeito de 'species')
#    Este é o comando mais importante para sua pergunta.
#    Ele testa se a variável 'species' como um todo é significativa.
print(Anova(modelo, type = "III"))
# 3. Interpretando a "Magnitude" do Efeito (Quem usou mais?)
coeficientes <- fixef(modelo)
odds_ratios <- exp(coeficientes)
print("Odds Ratios (Razão de Chances):")
print(odds_ratios)
# 1. O Resumo Padrão do Modelo
summary(modelo)
print(odds_ratios)
library(lme4)
# GLMM BINOMIAL
model <- glmer(trench_use ~ species + (1 | individual), data = type2_data, family = binomial(link = "logit"))
summary(model)
library(glmmTMB)
# GLMM BINOMIAL
model <- glmmTMB(trench_use ~ species + (1 | individual), data = type2_data,
family = binomial(link = "logit"))
summary(model)
check_distribution(model)
# pacotes necessarios --------------
library(tidyverse)
library(glmmTMB)
library(lme4)
library(DHARMa)
library(performance)
library(visreg)
library(patchwork)
library(ecodados)
library(MASS)
library(MuMIn)
library(Rmisc)
library(emmeans)
check_distribution(model)
trench_use
type2_data
check_distribution(model)
check_model(model)
simulateResiduals(model,plot=T)
testDispersion(model)
check_distribution(model)
glmmTMB::fixef(modelo)
# GLMM BINOMIAL
model <- glmer(trench_use ~ species + (1 | individual), data = type2_data,
family = binomial(link = "logit"))
# GLMM BINOMIAL
model <- glmer(trench_use ~ species + (1 | individual), data = type2_data,
family = binomial(link = "logit"))
glmer::fixef(modelo)
lme4::fixef(modelo)
# GLMM BINOMIAL
model <- glmmTMB(trench_use ~ species + (1 | individual), data = type2_data,
family = binomial(link = "logit"))
summary(model)
glmmTMB::fixef(modelo)
library(dplyr)
library(glmmTMB)
library(performance)
general_data <- read.csv(here::here("SM2_trench_trials.csv"), sep = ";")
type2_data <- general_data %>%
filter(type == 2) %>%
mutate(trench_use = ifelse(exit_way == "trench", 1, 0),
individual = as.factor(individual),
species = as.factor(species) ) %>%
select(individual, species, trench_use)
View(modelo)
View(type2_data)
# GLMM BINOMIAL
model <- glmmTMB(trench_use ~ species + (1 | individual), data = type2_data,
family = binomial(link = "logit"))
summary(model)
coefficient <- fixef(model)
coefficient
coefficient
coefficient <- fixef(model)
odds_ratios <- exp(coefficient)
coefficient <- fixef(model)
odds_ratios <- exp(coefficient)
coefficient <- lme4::fixef(model)
odds_ratios <- exp(coefficient)
general_data <- read.csv(here::here("SM2_trench_trials.csv"), sep = ";")
type2_data <- general_data %>%
filter(type == 2) %>%
mutate(trench_use = ifelse(exit_way == "trench", 1, 0),
individual = as.factor(individual),
species = as.factor(species) ) %>%
select(individual, species, trench_use)
library(dplyr)
library(glmmTMB)
library(performance)
general_data <- read.csv(here::here("SM2_trench_trials.csv"), sep = ";")
type2_data <- general_data %>%
filter(type == 2) %>%
mutate(trench_use = ifelse(exit_way == "trench", 1, 0),
individual = as.factor(individual),
species = as.factor(species) ) %>%
select(individual, species, trench_use)
# GLMM BINOMIAL
model <- glmmTMB(trench_use ~ species + (1 | individual), data = type2_data,
family = binomial(link = "logit"))
summary(model)
coefficient <- fixef(model)
View(coefficient)
odds_ratios <- exp(coefficient)
print(odds_ratios)
odds_ratios <- exp(coefficient$cond)
print(odds_ratios)
check_distribution(model)
check_model(model)
simulateResiduals(model,plot=T)
testDispersion(model)
summary(model)
library(dplyr)
library(glmmTMB)
library(performance)
general_data <- read.csv(here::here("SM2_trench_trials.csv"), sep = ";")
type2_data <- general_data %>%
filter(type == 2) %>%
mutate(trench_use = ifelse(exit_way == "trench", 1, 0),
individual = as.factor(individual),
species = as.factor(species) ) %>%
select(individual, species, trench_use)
View(type2_data)
View(general_data)
library(readxl)
SM1_individuals_measurements <- read_excel("SM1_individuals_measurements.xlsx")
View(SM1_individuals_measurements)
library(readxl)
SM1_individuals_measurements <- read_excel("SM1_individuals_measurements.xlsx")
View(SM1_individuals_measurements)
left_join(type2_data, SM1_individuals_measurements, by = individual)
View(SM1_individuals_measurements)
View(type2_data)
type2_data$individual
SM1_individuals_measurements$individual
measurements_data <- read_excel("SM1_individuals_measurements.xlsx") %>%
mutate(individual = as.factor(individual))
SM1_individuals_measurements$individual
measurements_data$individual
left_join(type2_data, measurements_data, by = individual)
left_join(type2_data, measurements_data, by = individual)
View(measurements_data)
general_data %>%
filter(type == 2) %>%
mutate(trench_use = ifelse(exit_way == "trench", 1, 0),
individual = as.factor(individual),
species = as.factor(species) ) %>%
select(individual, species, trench_use)
measurements_data
general_data %>%
filter(type == 2) %>%
mutate(trench_use = ifelse(exit_way == "trench", 1, 0),
individual = as.factor(individual),
species = as.factor(species) ) %>%
select(individual, species, trench_use) %>%
left_join(measurements_data, by = c("individual"))
general_data <- read.csv(here::here("SM2_trench_trials.csv"), sep = ";")
measurements_data <- read_excel("SM1_individuals_measurements.xlsx") %>%
mutate(individual = as.factor(individual))
general_data %>%
filter(type == 2) %>%
mutate(trench_use = ifelse(exit_way == "trench", 1, 0),
individual = as.factor(individual),
species = as.factor(species) ) %>%
left_join(measurements_data, by = c("individual")) %>%
select(individual, species, trench_use, carapace_length)
general_data %>%
filter(type == 2) %>%
mutate(trench_use = ifelse(exit_way == "trench", 1, 0),
individual = as.factor(individual),
species = as.factor(species) ) %>%
left_join(measurements_data, by = c("individual"))
general_data %>%
filter(type == 2) %>%
mutate(trench_use = ifelse(exit_way == "trench", 1, 0),
individual = as.factor(individual),
species = as.factor(species) ) %>%
left_join(measurements_data, by = c("individual"))
general_data <- read.csv(here::here("SM2_trench_trials.csv"), sep = ";")
measurements_data <- read_excel("SM1_individuals_measurements.xlsx") %>%
mutate(individual = as.factor(individual))
general_data %>%
filter(type == 2) %>%
mutate(trench_use = ifelse(exit_way == "trench", 1, 0),
individual = as.factor(individual),
species = as.factor(species) ) %>%
left_join(measurements_data, by = c("individual"))
general_data <- read.csv(here::here("SM2_trench_trials.csv"), sep = ";")
general_data %>%
filter(type == 2) %>%
mutate(trench_use = ifelse(exit_way == "trench", 1, 0),
individual = as.factor(individual),
species = as.factor(species) ) %>%
left_join(measurements_data, by = c("individual"))
type2_data <- general_data %>%
filter(type == 2) %>%
mutate(trench_use = ifelse(exit_way == "trench", 1, 0),
individual = as.factor(individual),
species = as.factor(species) ) %>%
left_join(measurements_data, by = c("individual")) %>%
select(individual, species.x, trench_use, carapace_length) %>%
rename(species = species.x)
general_data <- read.csv(here::here("SM2_trench_trials.csv"), sep = ";")
measurements_data <- read_excel("SM1_individuals_measurements.xlsx") %>%
mutate(individual = as.factor(individual))
View(measurements_data)
general_data %>%
filter(type == 2) %>%
mutate(trench_use = ifelse(exit_way == "trench", 1, 0),
individual = as.factor(individual),
species = as.factor(species) ) %>%
left_join(measurements_data, by = c("individual"))
general_data <- read.csv(here::here("SM2_trench_trials.csv"), sep = ";")
measurements_data <- read_excel("SM1_individuals_measurements.xlsx") %>%
mutate(individual = as.factor(individual))
type2_data <- general_data %>%
filter(type == 2) %>%
mutate(trench_use = ifelse(exit_way == "trench", 1, 0),
individual = as.factor(individual),
species = as.factor(species) ) %>%
left_join(measurements_data, by = c("individual")) %>%
select(individual, species.x, trench_use, carapace_length) %>%
rename(species = species.x)
View(type2_data)
# GLMM BINOMIAL
model <- glmmTMB(trench_use ~ species + (1 | individual), data = type2_data,
family = binomial(link = "logit"))
summary(model)
# GLMM BINOMIAL
model <- glmmTMB(trench_use ~ species + carapace_length + (1 | individual), data = type2_data,
family = binomial(link = "logit"))
summary(model)
# GLMM BINOMIAL
model <- glmmTMB(trench_use ~ carapace_length + (1 | individual), data = type2_data,
family = binomial(link = "logit"))
summary(model)
# GLMM BINOMIAL
model <- glmmTMB(trench_use ~ species * carapace_length + (1 | individual), data = type2_data,
family = binomial(link = "logit"))
summary(model)
# GLMM BINOMIAL
model <- glmmTMB(trench_use ~ species + carapace_length + (1 | individual), data = type2_data,
family = binomial(link = "logit"))
summary(model)
fixef(model)
coefficient <- fixef(model)
odds_ratios <- exp(coefficient$cond)
print(odds_ratios)
# GLMM BINOMIAL
model <- glmmTMB(trench_use ~ species * carapace_length + (1 | individual), data = type2_data,
family = binomial(link = "logit"))
summary(model)
# GLMM BINOMIAL
model <- glmmTMB(trench_use ~ species + carapace_length + (1 | individual), data = type2_data,
family = binomial(link = "logit"))
summary(model)
summary(model)
coefficient <- fixef(model)
odds_ratios <- exp(coefficient$cond)
print(odds_ratios)
View(general_data)
general_data %>%
filter(type == "no_trench")
general_data %>%
filter(type == "no_trench") %>%
mutate(exit = ifelse(exit_way == "rail", 1, 0),
individual = as.factor(individual),
species = as.factor(species) ) %>%
left_join(measurements_data, by = c("individual")) %>%
select(individual, species.x, exit, carapace_length) %>%
rename(species = species.x)
no_trench <- general_data %>%
filter(type == "no_trench") %>%
mutate(exit = ifelse(exit_way == "rail", 1, 0),
individual = as.factor(individual),
species = as.factor(species) ) %>%
left_join(measurements_data, by = c("individual")) %>%
select(individual, species.x, exit, carapace_length) %>%
rename(species = species.x)
model_no_trench <- glmmTMB(exit ~ species + carapace_length + (1 | individual), data = no_trench,
family = binomial(link = "logit"))
summary(model_no_trench)
model_no_trench <- glmmTMB(exit ~ species + (1 | individual), data = no_trench,
family = binomial(link = "logit"))
summary(model_no_trench)
no_trench
model_no_trench <- glmmTMB(exit ~ species + (1 | individual), data = no_trench,
family = binomial(link = "logit"))
summary(model_no_trench)
model_no_trench <- glmmTMB(exit ~ species, data = no_trench,
family = binomial(link = "logit"))
summary(model_no_trench)
no_trench
summary(model)
summary(model)
library(performance)
library(dplyr)
library(glmmTMB)
library(performance)
general_data <- read.csv(here::here("SM2_trench_trials.csv"), sep = ";")
measurements_data <- read_excel("SM1_individuals_measurements.xlsx") %>%
mutate(individual = as.factor(individual))
type2_data <- general_data %>%
filter(type == 2) %>%
mutate(trench_use = ifelse(exit_way == "trench", 1, 0),
individual = as.factor(individual),
species = as.factor(species) ) %>%
left_join(measurements_data, by = c("individual")) %>%
select(individual, species.x, trench_use, carapace_length) %>%
rename(species = species.x)
View(type2_data)
# GLMM BINOMIAL
model <- glmmTMB(trench_use ~ species + carapace_length + (1 | individual), data = type2_data,
family = binomial(link = "logit"))
summary(model)
check_model(model)
check_distribution(model)
check_residuals(model)
summary(model)
check_model(model)
library(dplyr)
library(glmmTMB)
library(performance)
general_data <- read.csv(here::here("SM2_trench_trials.csv"), sep = ";")
measurements_data <- read_excel("SM1_individuals_measurements.xlsx") %>%
mutate(individual = as.factor(individual))
type2_data <- general_data %>%
filter(type == 2) %>%
mutate(trench_use = ifelse(exit_way == "trench", 1, 0),
individual = as.factor(individual),
species = as.factor(species) ) %>%
left_join(measurements_data, by = c("individual")) %>%
select(individual, species.x, trench_use, carapace_length) %>%
rename(species = species.x)
# GLMM BINOMIAL
model <- glmmTMB(trench_use ~ species + carapace_length + (1 | individual), data = type2_data,
family = binomial(link = "logit"))
summary(model)
# GLMM BINOMIAL
model <- glmmTMB(trench_use ~ species + (1 | individual), data = type2_data,
family = binomial(link = "logit"))
summary(model)
# GLMM BINOMIAL
model <- glmmTMB(trench_use ~ species + carapace_length + (1 | individual), data = type2_data,
family = binomial(link = "logit"))
summary(model)
check_model(model)
check_residuals(model)
coefficient <- fixef(model)
odds_ratios <- exp(coefficient$cond)
print(odds_ratios)
library(lme4)
# GLMM BINOMIAL
model <- lmer(trench_use ~ species + carapace_length + (1 | individual), data = type2_data,
family = binomial(link = "logit"))
# GLMM BINOMIAL
model <- glmer(trench_use ~ species + carapace_length + (1 | individual), data = type2_data,
family = binomial(link = "logit"))
summary(model)
check_model(model)
check_residuals(model)
coefficient <- fixef(model)
odds_ratios <- exp(coefficient)
print(odds_ratios)
library(glmmTMB)
# GLMM BINOMIAL
model <- glmmTMB(trench_use ~ species + carapace_length + (1 | individual), data = type2_data,
family = binomial(link = "logit"))
summary(model)
check_model(model)
check_residuals(model)
coefficient <- fixef(model)
View(coefficient)
coefficient[["cond"]][["carapace_length"]]
odds_ratios <- exp(coefficient)
odds_ratios <- exp(coefficient$cond)
print(odds_ratios)
summary(model)
effectsize::odds_to_probs(model)
install.packages("sJplot")
install.packages("sjPlot")
sjPlot::tab_model(model, transform = "exp")
check_residuals(model)
sjPlot::tab_model(model, transform = "exp")
sjPlot::tab_model(model, transform = "exp", file = "model_table.doc")
sjPlot::tab_model(model, transform = "exp", file = "SM2_model_table.doc")
